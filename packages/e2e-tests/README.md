# NEAR Wallet E2E Tests

An end to end test suite for NEAR Wallet flows. Intended to verify and assert that all major flows are functional.

Setup
---

#### To run the test suite
1. Add the following environment variables in a env file place under `packages/e2e-tests`
    * **`BANK_ACCOUNT`**: This is the account id the test suite will use to generate temporary sub accounts for testing.
    * **`BANK_SEED_PHRASE`**: The seed phrase for the `BANK_ACCOUNT`
    * **`TEST_ACCOUNT_SEED_PHRASE`**: Seed phrase to use for accounts temporarily generated by the test suite. 
    * **`TEST_ACCOUNT_ID`**: AccountId for TEST_ACCOUNT_SEED_PHRASE
    * **`WALLET_NETWORK`**: The wallet network (/mainnet|testnet|betanet/) to run the tests against. defaults to testnet
    * **`NODE_URL`** (optional): The rpc node to use for the test suite's connection to NEAR. defaults to https://rpc.testnet.near.org
    * **`WALLET_URL`** (optional): The wallet URL to use in the test suite. defaults to local frontend (https://localhost:1234)
2. Start frontend
    * `cd packages/frontend`
    * `yarn dev`
3. Start guestbook
    * `cd packages/guestbook`
    * `yarn dev`
4. Run in e2e-tests directory
    * `yarn && yarn run e2e` or 
    * `yarn && yarn run e2e:debug` to run in [debug mode](https://playwright.dev/docs/debug#run-in-debug-mode) or
    * `yarn && yarn run e2e:ui` to run in [UI mode](https://playwright.dev/docs/test-ui-mode)

Tooling
---
* This module uses [Playwright](https://playwright.dev/) to include support for webkit and multi-tab flows
* This module uses the official [Playwright Test](https://www.npmjs.com/package/@playwright/test) test runner

Best Practices and Design Decisions
---
#### [Jest](https://github.com/playwright-community/jest-playwright) vs [Playwright Test runner](https://www.npmjs.com/package/@playwright/test)
*    We opted for the official Playwright test runner
*    We prefer a simpler setup with less moving parts and APIs to reason about
*    Support for [testing-library](https://github.com/hoverinc/playwright-testing-library) queries is not crucial to us at the moment since we intend to use **test-id**s frequently in our end to end test suite. More on this below.

#### Test IDs vs User driven selectors and queries
* We will use test-ids frequently in our end to end tests. We will use user centric queries as encouraged by [testing library](https://testing-library.com/) in our unit and integration tests.
* This is because our main goal here is functionality not accessibility or visibility
* Having said that, we will not overuse **test-id**s since we don't want to add too much maintenance overhead